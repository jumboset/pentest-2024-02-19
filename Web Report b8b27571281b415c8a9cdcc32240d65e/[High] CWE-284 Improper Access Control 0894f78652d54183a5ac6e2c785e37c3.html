<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>[High] CWE-284: Improper Access Control</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="0894f786-52d5-4183-a5ac-6e2c785e37c3" class="page sans"><header><h1 class="page-title">[High] <strong><strong>CWE-284: Improper Access Control</strong></strong></h1><p class="page-description"></p></header><div class="page-body"><figure id="b8b27571-281b-415c-8a9c-dcc32240d65e" class="link-to-page"><a href="../Web%20Report%20b8b27571281b415c8a9cdcc32240d65e.html">Back</a></figure><h1 id="f414f671-2556-4804-adbd-d4fea66c6294" class="">Affected URLst</h1><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="024d27c6-4552-4400-a4f4-4be2bc67d9f0" class="code"><code class="language-Plain Text">[DELETE] https://dronesurvey-dev.thaicom.io/droneapi/api/site/PYOS7/images/2
[POST] https://dronesurvey-dev.thaicom.io/droneapi/api/upload
[PUT] https://dronesurvey-dev.thaicom.io/droneapi/api/site/PYOS7/image
[DELETE] https://dronesurvey-dev.thaicom.io/droneapi/api/pdf/site/LTC99/report/65ce0341752c3f52ffadc434
[PUT] https://dronesurvey-dev.thaicom.io/droneapi/api/site/LTC99/sitegroups
[DELETE] https://dronesurvey-dev.thaicom.io/droneapi/user-management/admin/user/65ca1b03077c28e026cec769
[PUT] https://dronesurvey-dev.thaicom.io/droneapi/api/users/65ca1b03077c28e026cec769/sitegroups
[GET] https://dronesurvey-dev.thaicom.io/droneapi/user-management/admin/users/admin/aaa
[GET] https://dronesurvey-dev.thaicom.io/droneapi/user-management/admin/users/all/aaa
[GET] https://dronesurvey-dev.thaicom.io/droneapi/user-management/admin/users/officer/aaa
[GET] https://dronesurvey-dev.thaicom.io/droneapi/user-management/admin/users
[POST] https://dronesurvey-dev.thaicom.io/droneapi/api/sync/outputs/sites/AYSTM/outputType/point_cloud
[GET] https://dronesurvey-dev.thaicom.io/droneapi/api/sync/last/sites/LTC99
[POST] https://dronesurvey-dev.thaicom.io/droneapi/api/site/DUMMY/report
[POST] https://dronesurvey-dev.thaicom.io/droneapi/api/pdf/site/LTC99/report
[POST] https://dronesurvey-dev.thaicom.io/droneapi/api/pointcloudforcad/sites/LTC99</code></pre><h1 id="6d66ddd2-2eb2-4195-bd23-ba034ebd2f9d" class="">Risk</h1><p id="ef31671e-7746-428b-ae69-cbfdc1787372" class="">High</p><h1 id="f8f04358-4687-42e9-9828-1e196a90a168" class="">Impact</h1><p id="12be7eee-84df-430a-8a64-0ccb62ba5076" class="">High</p><h1 id="605ba3c5-7d51-4902-98ec-a2080456678f" class="">Likelihood</h1><p id="41048f46-7765-408e-90bb-d38d9e910c3a" class="">Medium</p><h1 id="fc92f970-fa23-4b79-a424-ed539d3785b5" class="">Description</h1><p id="d598f040-b0ab-4e6d-846d-41484e1c6095" class="">The Missing Function Level Access Control vulnerability occurs when an application fails to properly enforce access controls on various functions or resources based on user roles or privileges. This oversight allows unauthorized users to access functionalities or endpoints that they shouldn&#x27;t have permissions for, leading to potential data exposure, manipulation, or compromise.</p><p id="da31b754-417f-456b-9465-26e1b89dbfbb" class="">For instance, an application might grant access to certain functions or features to users without verifying their authorization or role. This could enable unauthorized users to perform actions that should be restricted to privileged or authenticated accounts. Attackers exploiting this vulnerability can gain unauthorized access to sensitive information, manipulate functionalities, or perform actions that compromise the security and integrity of the application.</p><p id="eb7fb936-1caf-4b93-89b0-7f14e124716d" class="">The absence of granular access controls exposes the application to various risks, including unauthorized data retrieval, modification, or deletion. In scenarios where sensitive operations are accessible without proper authorization checks, attackers can exploit this vulnerability to escalate privileges or perform malicious activities, compromising the confidentiality and integrity of the system.</p><h1 id="5512ed8d-7a9a-46d8-955c-4f4aff7b92f7" class="">Recommendation</h1><p id="245b167d-2c51-4931-b958-f76dc690b1fc" class="">Please carefully review the desired user access matrix, and reimplement the authorization between the role in order to prevent the unauthorized access across functions and roles.</p><h1 id="a5c747b4-43b8-4618-9707-1da8009410b9" class="">Evidences</h1><h2 id="7ea71cf4-3d8e-4a0f-9c81-42d154571a86" class="">Example 1: Arbitrary deletion of images</h2><p id="fd86739c-bdc8-4bb5-abc7-934367aaa1bd" class="">1. At the function “ตำแหน่งและสถานที่ &gt; ภาคกลาง &gt; {{site_name}}”, only the Admin could delete the images that uploaded to the App via <code>DELETE /droneapi/api/site/{{site_name}}/images/{{image_id}}</code>. For example, these images belonged to <code>PYOS7</code> site with the image ID <code>1</code> and <code>2</code> respectively.</p><figure id="ec315e77-44a9-4b4b-9f50-c6e347a324a0" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled.png"><img style="width:603px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled.png"/></a></figure><p id="f6b617c5-8312-4128-9bf1-c5d1b56f718e" class="">2. The Officer role could directly call the API <code>DELETE /droneapi/api/site/{{site_name}}/images/{{image_id}}</code> in order to delete the arbitrary image of particular sites.</p><figure id="e6d08ddc-86d9-4dc2-80bf-47851d152747" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%201.png"><img style="width:416px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%201.png"/></a></figure><p id="3ba452ba-02fc-470a-b9a9-3406b1fde799" class="">3. The result showed that <code>PYOS7</code> site has only 1 image ID <code>1</code> left.</p><figure id="86cb3980-0ba0-4cc5-999d-eecd924f2616" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%202.png"><img style="width:807px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%202.png"/></a></figure><p id="8d9acd1c-aedf-449f-9d4a-b598506f75e5" class="">4. We could also check that the image ID <code>2</code> of <code>PYOS7</code> was disappeared using Admin role.</p><figure id="7089a7cf-f45c-4273-8f3f-9986ffe97d5d" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%203.png"><img style="width:666px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%203.png"/></a></figure><h2 id="5a1acb39-bb38-4987-ac35-b9be65ff9e31" class="">Example 2: Arbitrary upload the files</h2><p id="5735abf8-c1db-4bfb-a8b3-1e45fd15cdc8" class="">1. At the function “ตำแหน่งและสถานที่ &gt; ภาคกลาง &gt; {{site_name}}”, only the Admin could upload the images to the App via <code>POST /droneapi/api/upload</code>.</p><figure id="ac220736-3b5e-4792-b571-4a16de251d8b" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%204.png"><img style="width:543px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%204.png"/></a></figure><p id="05a7ff30-1d38-44a5-a5c3-fc38a597ed9c" class="">2. The Officer role could directly call the API <code>POST /droneapi/api/upload</code> in order to upload the images to particular sites.</p><figure id="2908ade2-b1e1-4d44-853c-7b055e573928" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%205.png"><img style="width:533px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%205.png"/></a></figure><p id="f6dc9658-0bcd-45ac-9ca3-789d7016415c" class="">3. The result showed that the file had been successfully uploaded to the object storage.</p><figure id="792ebb2b-0ab2-4398-b8d2-3495581eed0b" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%206.png"><img style="width:685px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%206.png"/></a></figure><p id="16c4d1ec-8324-49e7-bb61-06237bdf0409" class="">4. In addition, the Officer role could also attach the link that uploaded previously to the site via <code>PUT /droneapi/api/site/PYOS7/image</code> to complete the upload process.</p><figure id="d74f2d88-1760-4fd3-b8ce-cbfcbbbffad1" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%207.png"><img style="width:517px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%207.png"/></a></figure><p id="efcea8d3-1711-41f8-84a3-42a25ef08303" class="">5. The result showed that the link was attached successfully.</p><figure id="1ee03e4e-57ae-4600-a79e-305460f91e2f" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%208.png"><img style="width:812px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%208.png"/></a></figure><p id="86427344-f795-44bf-b0e6-db597ab5d395" class="">6. We could also check the attacked link using Admin role.</p><figure id="22f2f73e-5561-47e0-a5ed-b3e2b7c75710" class="image"><a href="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%209.png"><img style="width:743px" src="%5BHigh%5D%20CWE-284%20Improper%20Access%20Control%200894f78652d54183a5ac6e2c785e37c3/Untitled%209.png"/></a></figure><figure id="b8b27571-281b-415c-8a9c-dcc32240d65e" class="link-to-page"><a href="../Web%20Report%20b8b27571281b415c8a9cdcc32240d65e.html">Back</a></figure><p id="c8ebdaea-3464-42dd-a38a-e3510ee9142f" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>